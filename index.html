<!DOCTYPE html>
<html lang="bn">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>‡¶π‡ßã‡¶Æ‡¶®‡¶æ ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡ßü‡¶æ‡¶∞ ‡¶≤‡ßÄ‡¶ó - ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶®</title>
      <style>
         body {
         margin: 0;
         font-family: Arial, sans-serif;
         background: #f2f2f2;
         }
         .banner {
         background: linear-gradient(135deg, #0f9d58, #0b8043);
         color: white;
         padding: 30px 15px;
         text-align: center;
         }
         .container {
         max-width: 420px;
         background: white;
         margin: -20px auto 20px;
         padding: 20px;
         border-radius: 12px;
         box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
         }
         label {
         display: block;
         margin-top: 10px;
         font-weight: bold;
         }
         input,
         select,
         button {
         width: 100%;
         padding: 9px;
         margin-top: 5px;
         border-radius: 6px;
         border: 1px solid #ccc;
         }
         button {
         margin-top: 15px;
         background: #0f9d58;
         color: white;
         font-size: 16px;
         border: none;
         cursor: pointer;
         }
         .preview-box {
         width: 100%;
         height: 180px;
         border: 2px dashed #0f9d58;
         border-radius: 10px;
         margin-top: 8px;
         display: flex;
         align-items: center;
         justify-content: center;
         overflow: hidden;
         background: #f9f9f9;
         position: relative;
         }
         .preview-box span {
         color: #999;
         position: absolute;
         }
         .preview-box img {
         width: 100%;
         height: 100%;
         object-fit: contain;
         display: none;
         }
         #msg {
         text-align: center;
         margin-top: 10px;
         font-weight: bold;
         }
      </style>
   </head>
   <body>
      <div class="banner">
         <h1>üèè ‡¶π‡ßã‡¶Æ‡¶®‡¶æ ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡ßü‡¶æ‡¶∞ ‡¶≤‡ßÄ‡¶ó</h1>
         <p>‡¶π‡ßã‡¶Æ‡¶®‡¶æ, ‡¶ï‡ßÅ‡¶Æ‡¶ø‡¶≤‡ßç‡¶≤‡¶æ</p>
      </div>
      <div class="container">
         <form id="regForm">
            <label>‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶õ‡¶¨‡¶ø</label>
            <input type="file" id="photo" accept="image/*" required />
            <div class="preview-box">
               <span id="previewText">‡¶õ‡¶¨‡¶ø</span>
               <img id="previewImg" />
            </div>
            <label>‡¶®‡¶æ‡¶Æ</label>
            <input type="text" id="name" required />
            <label>‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞</label>
            <input type="text" id="phone" required />
            <label>‡¶¨‡¶Ø‡¶º‡¶∏</label>
            <input type="number" id="age" required />
            <label>‡¶•‡¶æ‡¶®‡¶æ</label>
            <input type="text" value="‡¶π‡ßã‡¶Æ‡¶®‡¶æ" disabled />
            <label>‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ</label>
            <input type="text" id="village" required />
            <label>‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶ß‡¶∞‡¶®</label>
            <select id="playerType" required>
               <option value="">‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</option>
               <option>‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®</option>
               <option>‡¶¨‡ßã‡¶≤‡¶æ‡¶∞</option>
               <option>‡¶Ö‡¶≤‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°‡¶æ‡¶∞</option>
            </select>
            <label>‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤</label>
            <select id="battingStyle">
               <option>‡¶°‡¶æ‡¶® ‡¶π‡¶æ‡¶§‡¶ø ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®</option>
               <option>‡¶¨‡¶æ‡¶Æ ‡¶π‡¶æ‡¶§‡¶ø ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®</option>
            </select>
            <label>‡¶¨‡ßã‡¶≤‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤</label>
            <select id="bowlingStyle">
               <option>‡¶°‡¶æ‡¶® ‡¶π‡¶æ‡¶§‡¶ø ‡¶¨‡ßã‡¶≤‡¶æ‡¶∞</option>
               <option>‡¶¨‡¶æ‡¶Æ ‡¶π‡¶æ‡¶§‡¶ø ‡¶¨‡ßã‡¶≤‡¶æ‡¶∞</option>
            </select>
            <button type="submit">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
         </form>
         <p id="msg"></p>
      </div>
      <!-- Supabase -->
      <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
      <!-- Firebase -->
      <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
      <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
      <script>
         const playerType = document.getElementById("playerType");
         const battingStyle = document.getElementById("battingStyle");
         const bowlingStyle = document.getElementById("bowlingStyle");
         
         // ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá ‡¶¶‡ßÅ‡¶ü‡ßã‡¶á disable ‡¶•‡¶æ‡¶ï‡¶¨‡ßá
         battingStyle.disabled = true;
         bowlingStyle.disabled = true;
         
         playerType.addEventListener("change", () => {
         const type = playerType.value;
         
         if (type === "‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®") {
         	battingStyle.disabled = false;
         	bowlingStyle.disabled = true;
         	bowlingStyle.value = "";
         }
         else if (type === "‡¶¨‡ßã‡¶≤‡¶æ‡¶∞") {
         	battingStyle.disabled = true;
         	bowlingStyle.disabled = false;
         	battingStyle.value = "";
         }
         else if (type === "‡¶Ö‡¶≤‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°‡¶æ‡¶∞") {
         	battingStyle.disabled = false;
         	bowlingStyle.disabled = false;
         }
         else {
         	battingStyle.disabled = true;
         	bowlingStyle.disabled = true;
         	battingStyle.value = "";
         	bowlingStyle.value = "";
         }
         });
           const supabaseUrl = "https://hbbjvvugkztfyudireqq.supabase.co";
           const supabaseKey =
             "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhiYmp2dnVna3p0Znl1ZGlyZXFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5Njg5NzgsImV4cCI6MjA4MTU0NDk3OH0.V8itypLUD7IVYZGFcfyJb0DLbb_bwCiBWv2gSCt28Qc"; // üîê keep anon key only
           const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);
         
           function sanitize(name) {
             return name.replace(/[^a-zA-Z0-9._-]/g, "_");
           }
         
           // Image preview
           document.getElementById("photo").addEventListener("change", (e) => {
             const file = e.target.files[0];
             if (!file) return;
         
             document.getElementById("previewImg").src = URL.createObjectURL(file);
             document.getElementById("previewImg").style.display = "block";
             document.getElementById("previewText").style.display = "none";
           });
         
           document
             .getElementById("regForm")
             .addEventListener("submit", async (e) => {
               e.preventDefault();
               const msg = document.getElementById("msg");
               msg.style.color = "black";
               msg.innerText = "‚è≥ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
         
               const file = document.getElementById("photo").files[0];
         
               if (!file || !file.type.startsWith("image/")) {
                 msg.innerText = "‚ùå ‡¶∏‡¶†‡¶ø‡¶ï ‡¶õ‡¶¨‡¶ø ‡¶¶‡¶ø‡¶®";
                 msg.style.color = "red";
                 return;
               }
         
               if (file.size > 2 * 1024 * 1024) {
                 msg.innerText = "‚ùå ‡¶õ‡¶¨‡¶ø 2MB ‡¶è‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá";
                 msg.style.color = "red";
                 return;
               }
         
               const fileName = Date.now() + "_" + sanitize(file.name);
         
               const { error: uploadError } = await supabaseClient.storage
                 .from("players")
                 .upload(fileName, file);
         
               if (uploadError) {
                 msg.innerText = "‚ùå ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•";
                 msg.style.color = "red";
                 return;
               }
         
               const { data } = supabaseClient.storage
                 .from("players")
                 .getPublicUrl(fileName);
               // ---------------- Firebase ----------------
               const firebaseConfig = {
                 apiKey: "AIzaSyDBoV5YQcY4PfV2aDzK88NK-C5L0Ny01_k",
                 authDomain: "cricket-tournament-17441.firebaseapp.com",
                 projectId: "cricket-tournament-17441",
                 storageBucket: "cricket-tournament-17441.firebasestorage.app",
                 messagingSenderId: "39486616682",
                 appId: "1:39486616682:web:f12a5eb36d1a6ae67d4613",
                 measurementId: "G-K9HWFXP1CE",
               };
               firebase.initializeApp(firebaseConfig);
               const db = firebase.firestore();
         
               const name = document.getElementById("name").value;
               const phone = document.getElementById("phone").value;
               const age = document.getElementById("age").value;
               const village = document.getElementById("village").value;
               const playerType = document.getElementById("playerType").value;
               const battingStyle = document.getElementById("battingStyle").value;
               const bowlingStyle = document.getElementById("bowlingStyle").value;
         
               // Save rest of data to Firebase
               try {
                 await db.collection("registrations").add({
                   name: name,
                   phone: phone,
                   age: age,
                   thana: "‡¶π‡ßã‡¶Æ‡¶®‡¶æ",
                   village: village,
                   player_type: playerType,
                   batting_style: battingStyle,
                   bowling_style: bowlingStyle,
                   photo_url: data.publicUrl,
                   created_at: firebase.firestore.FieldValue.serverTimestamp(),
                 });
                 msg.innerText = "‚úÖ ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶´‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá";
                 msg.style.color = "green";
                 e.target.reset();
                 previewImg.style.display = "none";
                 previewText.style.display = "block";
               } catch (err) {
                 console.error(err);
                 msg.innerText = "‚ùå ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•";
                 msg.style.color = "red";
               }
             });
      </script>
   </body>
   </html>
